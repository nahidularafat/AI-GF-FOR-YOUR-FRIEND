<!DOCTYPE html>
<html>
<head>
    <title>AI Girlfriend Chat</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script>
    <style>
        .ai-message { color: #d63384; font-weight: bold; } /* Pink color for AI */
        .user-message { color: #0d6efd; font-weight: bold; } /* Blue color for User */
        #chat-box { 
            height: 300px; 
            overflow-y: scroll; 
            background-color: #f8f9fa;
        }
    </style>
</head>
<body>
<div class="container mt-5">
    <h3>Chat with AI Girlfriend ðŸ’•</h3>
    <div id="chat-box" class="border p-3 mb-3">
        {% for msg in messages %}
            <div class="user-message">You: {{ msg.user_message }}</div>
            <div class="ai-message">AI: {{ msg.ai_message }}</div>
        {% endfor %}
    </div>
    <input type="text" id="user-input" class="form-control" placeholder="Type your message...">
    <button id="send-btn" class="btn btn-primary mt-2">Send</button>
</div>

<script>
$(document).ready(function() {
    // Scroll to the bottom of the chat box on load
    $('#chat-box').scrollTop($('#chat-box')[0].scrollHeight);
});

$('#send-btn').click(function(){
    let message = $('#user-input').val();
    if(message.trim() === "") return;
    
    // Display user message instantly
    $('#chat-box').append('<div class="user-message">You: '+message+'</div>');
    
    // Clear input and scroll down
    $('#user-input').val('');
    $('#chat-box').scrollTop($('#chat-box')[0].scrollHeight);
    
    // Send message to backend
    $.post("/get-response/", {message: message, csrfmiddlewaretoken: '{{ csrf_token }}'}, function(data){
        // Display AI response
        $('#chat-box').append('<div class="ai-message">AI: '+data.response+'</div>');
        $('#chat-box').scrollTop($('#chat-box')[0].scrollHeight);
    }).fail(function() {
         $('#chat-box').append('<div class="ai-message" style="color:red;">AI: Network Error. Could not connect to the server.</div>');
         $('#chat-box').scrollTop($('#chat-box')[0].scrollHeight);
    });
});
</script>
</body>
</html>